<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SeaConnect</title>

<style>

body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
background:linear-gradient(180deg,#0f172a,#1e293b);
color:#f1f5f9;
}

.page{
display:none;
padding:20px;
padding-bottom:95px;
}

.card{
background:rgba(255,255,255,0.06);
backdrop-filter:blur(12px);
border:1px solid rgba(255,255,255,0.08);
padding:18px;
border-radius:22px;
margin-bottom:16px;
box-shadow:0 10px 30px rgba(0,0,0,.35);
}

input{
width:100%;
padding:12px;
border-radius:14px;
border:1px solid rgba(255,255,255,0.15);
margin-top:6px;
box-sizing:border-box;
background:rgba(255,255,255,0.05);
color:#fff;
}

button{
padding:11px 16px;
border:none;
border-radius:14px;
font-weight:700;
cursor:pointer;
}

.primary{
background:linear-gradient(135deg,#3b82f6,#2563eb);
color:#fff;
}

.danger{
background:linear-gradient(135deg,#ef4444,#dc2626);
color:#fff;
}

.light{
background:rgba(255,255,255,0.1);
color:#fff;
}

.row{
display:flex;
gap:10px;
margin-top:12px;
}

.subText{
font-size:13px;
color:#94a3b8;
}

.bottomnav{
position:fixed;
bottom:15px;
left:50%;
transform:translateX(-50%);
width:90%;
height:65px;
background:rgba(15,23,42,0.9);
backdrop-filter:blur(10px);
border-radius:22px;
display:flex;
justify-content:space-around;
align-items:center;
box-shadow:0 10px 40px rgba(0,0,0,.6);
}

.bottomnav button{
background:none;
border:none;
font-size:12px;
font-weight:600;
color:#94a3b8;
}

.bottomnav button.active{
color:#3b82f6;
font-weight:800;
}

/* ONLINE RING */

.profileRing{
display:inline-block;
padding:4px;
border-radius:50%;
}

.profileRing.online{
border:3px solid #22c55e;
animation:pulseRing 2s infinite;
}

@keyframes pulseRing{
0%{box-shadow:0 0 0 0 rgba(34,197,94,.6);}
70%{box-shadow:0 0 0 10px rgba(34,197,94,0);}
100%{box-shadow:0 0 0 0 rgba(34,197,94,0);}
}

</style>
</head>

<body>

<!-- PROFILE -->

<div id="profilePage" class="page" style="display:block;">

<div style="display:flex;justify-content:space-between;">
<h2>ðŸ‘¤ My Profile</h2>
<button class="danger" onclick="logout()">Logout</button>
</div>

<div class="card" style="text-align:center">

<div id="profileRing" class="profileRing">

<img id="profilePhoto"
src="https://i.ibb.co/2kRZ7Z6/avatar.png"
style="width:120px;height:120px;border-radius:50%;object-fit:cover;border:4px solid #e5e7eb;">

</div>

<br><br>

<input type="file" id="photoInput" accept="image/*" style="display:none">

<button class="primary"
onclick="document.getElementById('photoInput').click()">
Upload Photo
</button>

<br><br>

<div id="profileName"
style="font-size:24px;font-weight:900"></div>

<div id="profileRank"
style="color:#6b7280"></div>

</div>

<!-- PROFESSIONAL INFO -->

<div class="card">

<div style="display:flex;justify-content:space-between;">
<div style="font-weight:900">Professional Information</div>

<button class="light" onclick="toggleInfo()" id="infoBtn">
Show
</button>
</div>

<div id="infoSection" style="display:none;margin-top:12px">

<div class="subText">Email</div>
<div id="profileEmail"></div>

<div class="subText">Company</div>
<div id="profileCompany"></div>

<div class="subText">Vessel</div>
<div id="profileVessel"></div>

<div class="subText">Experience</div>
<div id="profileExperience"></div>

<div class="subText">Phone</div>
<div id="profilePhone"></div>

<div class="subText">Address</div>
<div id="profileAddress"></div>

</div>
</div>

<div id="documentsList"></div>

</div>

<!-- NAV -->

<div class="bottomnav">

<button onclick="location.href='feeds.html'">
ðŸ“° Feeds
</button>

<button>
ðŸ‘¥ Friends
</button>

<button>
ðŸ’¬ Messages
</button>

<button class="active">
ðŸ‘¤ Profile
</button>

</div>

<script type="module">

import { initializeApp }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";

import {
getAuth,
onAuthStateChanged,
signOut
}
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

import {
getFirestore,
doc,
getDoc,
setDoc,
updateDoc
}
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig={
apiKey:"AIzaSyCNlodsmEHrSXxgH0gTOcx4cAXwG8qmG9w",
authDomain:"seaconnect-d2baa.firebaseapp.com",
projectId:"seaconnect-d2baa"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);

let currentUID=null;

onAuthStateChanged(auth,async(user)=>{

if(!user){
location.href="index.html";
return;
}

currentUID=user.uid;

await updateDoc(doc(db,"users",currentUID),{
online:true,
lastActive:Date.now()
});

loadProfile();

});

/* SET OFFLINE WHEN LEAVE PAGE */

window.addEventListener("beforeunload",async()=>{

if(currentUID){

await updateDoc(doc(db,"users",currentUID),{
online:false,
lastActive:Date.now()
});

}

});

async function loadProfile(){

const snap=await getDoc(doc(db,"users",currentUID));

const d=snap.data()||{};

const ring=document.getElementById("profileRing");

if(d.online){
ring.classList.add("online");
}else{
ring.classList.remove("online");
}

if(d.photo){
profilePhoto.src=d.photo;
}

profileName.innerText=d.name||"";
profileRank.innerText=d.rank||"";

profileEmail.innerText=d.email||"";
profileCompany.innerText=d.company||"-";
profileVessel.innerText=d.vessel||"-";
profileExperience.innerText=d.experience||"-";
profilePhone.innerText=d.phone||"-";
profileAddress.innerText=d.address||"-";

}

window.logout=async function(){

await updateDoc(doc(db,"users",currentUID),{
online:false,
lastActive:Date.now()
});

await signOut(auth);

location.href="index.html";

};

</script>

</body>
</html>
